<html>
<head>
<title>ThreatConnect Javascript SDK</title>

<script src="./libs/jquery-1.11.3.js" type="text/javascript"></script>
<script src="./libs/core.js" type="text/javascript"></script>
<script src="./libs/sha256.js" type="text/javascript"></script>
<script src="./libs/hmac.js" type="text/javascript"></script>
<script src="./libs/enc-base64.js" type="text/javascript"></script>
<script src="./threatconnect.js" type="text/javascript"></script>

</head>

<body>
    <button id="get">GET</button>
    <button id="post">POST</button>

    <br/>
    
    <div id="content"></div>
</body>

<script>
    apiSettings = {
        apiId: '75648495203246550474',
        apiSec: '(q~*].gkMT}!y{$o@4lt>U{GX39:_2uXX-ZXyH(kL4dw4Ei&s!Ls!g1|!AXS2}mi',
        apiUrl: 'https://ti.sumx.us/api'
    };
    
    ro = new RequestObject(apiSettings);
    
    getRandom = {
        ip: function() {
            return [
                Math.floor(Math.random() * 255) + 1,
                Math.floor(Math.random() * 255) + 1,
                Math.floor(Math.random() * 255) + 1,
                Math.floor(Math.random() * 255) + 1
            ].join('.');
        },
        
        rating: function() {
            return Math.floor(Math.random() * 5) + 1;
        },
        
        confidence: function() {
            return Math.floor(Math.random() * 100) + 1;
        }
    };
    
    $('#get').on('click', function() {
        ro.setOwner('test org')
            .setActivityLog(true)
            .setRequestUri('v2/indicators')
            .setRequestMethod("GET")
            .setPagination(true)
            .setOwnerAllowed(true)
            .setResultLimit(500)
            .apiRequest({
                complete: function(data) {
                    $('#content').text(JSON.stringify(data, null, 4));
                }
            });
    });

    $('#post').on('click', function() {
        ro.setOwner('test org')
            .setActivityLog(false)
            .setRequestMethod("POST")
            .setBody({
                'ip': getRandom.ip(),
                'rating': getRandom.rating(),
                'confidence': getRandom.confidence(),
            })
            .setRequestUri('v2/indicators/addresses')
            .setPagination(false)
            .setOwnerAllowed(false)
            .apiRequest({
                complete: function(data) {
                    $('#content').text(JSON.stringify(data, null, 4));
                }
            });
    });
    
</script>
</html>
